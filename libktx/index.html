<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libktx - The KTX Library: Introduction</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libktx - The KTX Library
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Introduction </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>libktx is a small library of functions for creating and reading KTX (Khronos TeXture) files and instantiating OpenGL&reg; and OpenGL&reg; ES textures and Vulkan images from them.</p>
<p>For information about the KTX format see the <a href="http://www.khronos.org/opengles/sdk/tools/KTX/file_format_spec/">formal specification.</a></p>
<p>The library is open source software. Source code is available at <a href="https://github.com/KhronosGroup/KTX">GitHub</a>. Most of the source code and the documentation is licensed under the Apache 2.0 license. See <a class="el" href="license.html">License and Attribution Notices</a> for details. When distributing the library, whether in source or binary form, this documentation must be included in the distribution or otherwise made available to recipients.</p>
<p>See <a class="el" href="libktx_history.html">Revision History</a> for the list of changes.</p>
<p>See <a class="el" href="todo.html">To Do List</a> for the current To Do list.</p>
<dl class="section author"><dt>Authors</dt><dd>Mark Callow, <a href="http://www.edgewise-consulting.com">Edgewise Consulting</a>, formerly at <a href="http://www.hicorp.co.jp">HI Corporation</a><br />
Georg Kolling, <a href="http://www.imgtec.com">Imagination Technology</a><br />
Jacob Str&ouml;m, <a href="http://www.ericsson.com">Ericsson AB</a></dd></dl>
<dl class="section version"><dt>Version</dt><dd>3.0.0</dd></dl>
<dl class="section rcs"><dt>Date</dt><dd>Fri May 18 15:30:24 2018 +0900 </dd></dl>
<h1><a class="anchor" id="overview"></a>
Usage Overview</h1>
<h2><a class="anchor" id="readktx"></a>
Reading a KTX file for non-GL and non-Vulkan Use</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="ktx_8h.html">ktx.h</a>&gt;</span></div><div class="line"></div><div class="line"><a class="code" href="structktxTexture.html">ktxTexture</a>* texture;</div><div class="line"><a class="code" href="ktx_8h.html#a8de6927e772cc95a9f49593c3dd72069">KTX_error_code</a> result;</div><div class="line">ktx_size_t offset;</div><div class="line">ktx_uint8_t* image;</div><div class="line">ktx_uint32_t level, layer, faceSlice;</div><div class="line"></div><div class="line">result = <a class="code" href="group__reader.html#ga57a1ce0d3f2d66439463160d6ce9d2d0">ktxTexture_CreateFromNamedFile</a>(<span class="stringliteral">&quot;mytex3d.ktx&quot;</span>,</div><div class="line">                                        <a class="code" href="ktx_8h.html#a5d741f48293002f70546881d2394b6f6">KTX_TEXTURE_CREATE_LOAD_IMAGE_DATA_BIT</a>,</div><div class="line">                                        &amp;texture);</div><div class="line"></div><div class="line"><span class="comment">// Retrieve information about the texture from fields in the ktxTexture</span></div><div class="line"><span class="comment">// such as:</span></div><div class="line">ktx_uint32 numLevels = texture-&gt;<a class="code" href="structktxTexture.html#af9a0b75d5b66a8b6dbb4f70e18ad8df5">numLevels</a>;</div><div class="line">ktx_uint32 baseWidth = texture-&gt;<a class="code" href="structktxTexture.html#a7e100dde38eba1761b3db13e63a88d9d">baseWidth</a>;</div><div class="line">ktx_bool_t isArray = texture-&gt;<a class="code" href="structktxTexture.html#a14bb2d2f42a65eb970655cbb5e37d360">isArray</a>;</div><div class="line"></div><div class="line"><span class="comment">// Retrieve a pointer to the image for a specific mip level, array layer</span></div><div class="line"><span class="comment">// &amp; face or depth slice.</span></div><div class="line">level = 1; layer = 0; faceSlice = 3;</div><div class="line">result = <a class="code" href="group__reader.html#gabfd78734a5bc4e4147ee58ea5e879620">ktxTexture_GetImageOffset</a>(texture, level, layer, faceSlice, &amp;offset);</div><div class="line">image = <a class="code" href="group__reader.html#gace44d98fa78b94c282016e7cf8a88b7e">ktxTexture_GetData</a>(texture) + offset;</div><div class="line"><span class="comment">// ...</span></div><div class="line"><span class="comment">// Do something with the texture image.</span></div><div class="line"><span class="comment">// ...</span></div><div class="line"><a class="code" href="group__reader.html#ga87b33b5bb53c98814f888ef888c62476">ktxTexture_Destroy</a>(texture);</div></div><!-- fragment --><h2><a class="anchor" id="createGL"></a>
Creating a GL texture object from a KTX file.</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="ktx_8h.html">ktx.h</a>&gt;</span></div><div class="line"></div><div class="line"><a class="code" href="structktxTexture.html">ktxTexture</a>* kTexture;</div><div class="line"><a class="code" href="ktx_8h.html#a8de6927e772cc95a9f49593c3dd72069">KTX_error_code</a> result;</div><div class="line">ktx_size_t offset;</div><div class="line">ktx_uint8_t* image;</div><div class="line">ktx_uint32_t level, layer, faceSlice;</div><div class="line">GLuint texture = 0;</div><div class="line">GLenum target, glerror;</div><div class="line"></div><div class="line">result = <a class="code" href="group__reader.html#ga57a1ce0d3f2d66439463160d6ce9d2d0">ktxTexture_CreateFromNamedFile</a>(<span class="stringliteral">&quot;mytex3d.ktx&quot;</span>,</div><div class="line">                                        KTX_TEXTURE_CREATE_NO_FLAGS,</div><div class="line">                                        &amp;kTexture);</div><div class="line">glGenTextures(1, &amp;texture); <span class="comment">// Optional. GLUpload can generate a texture.</span></div><div class="line">result = ktxtexture_GLUpload(kTexture, &amp;texture, &amp;target, &amp;glerror);</div><div class="line"><a class="code" href="group__reader.html#ga87b33b5bb53c98814f888ef888c62476">ktxTexture_Destroy</a>(texture);</div><div class="line"><span class="comment">// ...</span></div><div class="line"><span class="comment">// GL rendering using the texture</span></div><div class="line"><span class="comment">// ...</span></div></div><!-- fragment --><h2><a class="anchor" id="createVulkan"></a>
Creating a Vulkan image object from a KTX file.</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;ktxvulkan.h&gt;</span></div><div class="line"></div><div class="line"><a class="code" href="structktxTexture.html">ktxTexture</a>* kTexture;</div><div class="line"><a class="code" href="ktx_8h.html#a8de6927e772cc95a9f49593c3dd72069">KTX_error_code</a> result;</div><div class="line">ktx_size_t offset;</div><div class="line">ktx_uint8_t* image;</div><div class="line">ktx_uint32_t level, layer, faceSlice;</div><div class="line"><a class="code" href="structktxVulkanDeviceInfo.html">ktxVulkanDeviceInfo</a> vdi;</div><div class="line"><a class="code" href="structktxVulkanTexture.html">ktxVulkanTexture</a> texture;</div><div class="line"></div><div class="line"><span class="comment">// Set up Vulkan physical device (gpu), logical device (device), queue</span></div><div class="line"><span class="comment">// and command pool. Save the handles to these in a struct called vkctx.</span></div><div class="line"><span class="comment">// ktx VulkanDeviceInfo is used to pass these with the expectation that</span></div><div class="line"><span class="comment">// apps are likely to upload a large number of textures.</span></div><div class="line"><a class="code" href="group__ktx__vkloader.html#ga4bc9f0fa9af93d588276f54fe9a6ba50">ktxVulkanDeviceInfo_Construct</a>(&amp;vdi, vkctx.gpu, vkctx.device,</div><div class="line">                              vkctx.queue, vkctx.commandPool, <span class="keyword">nullptr</span>);</div><div class="line"></div><div class="line">ktxresult = <a class="code" href="group__reader.html#ga57a1ce0d3f2d66439463160d6ce9d2d0">ktxTexture_CreateFromNamedFile</a>(<span class="stringliteral">&quot;mytex3d.ktx&quot;</span>,</div><div class="line">                                           KTX_TEXTURE_CREATE_NO_FLAGS,</div><div class="line">                                           &amp;kTexture);</div><div class="line"></div><div class="line">ktxresult = <a class="code" href="group__ktx__vkloader.html#ga153164adbd7307ad1844c3e117faa325">ktxTexture_VkUploadEx</a>(kTexture, &amp;vdi, &amp;texture,</div><div class="line">                                  VK_IMAGE_TILING_OPTIMAL,</div><div class="line">                                  VK_IMAGE_USAGE_SAMPLED_BIT,</div><div class="line">                                  VK_IMAGE_LAYOUT_SHADER_READ_ONLY_OPTIMAL);</div><div class="line"></div><div class="line"><a class="code" href="group__reader.html#ga87b33b5bb53c98814f888ef888c62476">ktxTexture_Destroy</a>(kTexture);</div><div class="line"><a class="code" href="group__ktx__vkloader.html#gae58928740420d1ed3f96fd4b0f2d897e">ktxVulkanDeviceInfo_Destruct</a>(&amp;vdi);</div><div class="line"><span class="comment">// ...</span></div><div class="line"><span class="comment">// Vulkan rendering using the texture</span></div><div class="line"><span class="comment">// ...</span></div><div class="line"><span class="comment">// When done using the image in Vulkan...</span></div><div class="line"><a class="code" href="group__ktx__vkloader.html#gaf620a84f6bc59bff03b521e55a654f19">ktxVulkanTexture_Destruct</a>(&amp;texture, vkctx.device, <span class="keyword">nullptr</span>);</div></div><!-- fragment --><h2><a class="anchor" id="subsection"></a>
Extracting Metadata</h2>
<p>Once a <a class="el" href="structktxTexture.html" title="Class representing a texture.">ktxTexture</a> object has been created, metadata can be easily found and extracted. The following can be added to any of the above.</p>
<div class="fragment"><div class="line"><span class="keywordtype">char</span>* pValue;</div><div class="line">uint32_t valueLen;</div><div class="line"><span class="keywordflow">if</span> (<a class="code" href="ktx_8h.html#a8de6927e772cc95a9f49593c3dd72069afdb7a07b23399df43e1ecf161963cf98">KTX_SUCCESS</a> == <a class="code" href="classktxHashList.html#ab3625f19223436b718d9267f0b9a663a">ktxHashList_FindValue</a>(&amp;kTexture-&gt;<a class="code" href="structktxTexture.html#a6ccd386af95ea908e4d5c0e954e9ba5b">kvDataHead</a>,</div><div class="line">                                          <a class="code" href="ktx_8h.html#a7eebf850576083e740cf1f418eed39a0">KTX_ORIENTATION_KEY</a>,</div><div class="line">                                          &amp;valueLen, (<span class="keywordtype">void</span>**)&amp;pValue))</div><div class="line"> {</div><div class="line">      <span class="keywordtype">char</span> s, t;</div><div class="line"></div><div class="line">      <span class="keywordflow">if</span> (sscanf(pValue, <a class="code" href="ktx_8h.html#ad235113b0090e64ad23a0cf7097e1b7a">KTX_ORIENTATION2_FMT</a>, &amp;s, &amp;t) == 2) {</div><div class="line">         ...</div><div class="line">      }</div><div class="line"> }</div></div><!-- fragment --><h2><a class="anchor" id="writektx"></a>
Writing a KTX file</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="ktx_8h.html">ktx.h</a>&gt;</span></div><div class="line"></div><div class="line"><a class="code" href="structktxTexture.html">ktxTexture</a>* texture;</div><div class="line"><a class="code" href="structktxTextureCreateInfo.html">ktxTextureCreateInfo</a> createInfo;</div><div class="line"><a class="code" href="ktx_8h.html#a8de6927e772cc95a9f49593c3dd72069">KTX_error_code</a> result;</div><div class="line">ktx_uint32_t level, layer, faceSlice;</div><div class="line">FILE* src;</div><div class="line">ktx_size_t srcSize;</div><div class="line"></div><div class="line">createInfo.<a class="code" href="structktxTextureCreateInfo.html#a6d1bde0fd4b46618d1f15aa519e08c6b">glInternalformat</a> = GL_RGB8;</div><div class="line">createInfo.<a class="code" href="structktxTextureCreateInfo.html#ae817666a8c8ef8fbed5d81b52c421b9e">baseWidth</a> = 2048;</div><div class="line">createInfo.<a class="code" href="structktxTextureCreateInfo.html#af401308b301717196a51015aac339e90">baseHeight</a> = 1024;</div><div class="line">createInfo.<a class="code" href="structktxTextureCreateInfo.html#acd631299f24ac52bc6af9d9303251a0e">baseDepth</a> = 16;</div><div class="line">createInfo.<a class="code" href="structktxTextureCreateInfo.html#aee982947789840643580ef13d9209124">numDimensions</a> = 3.</div><div class="line"><span class="comment">// Note: it is not necessary to provide a full mipmap pyramid.</span></div><div class="line">createInfo.numLevels = log2(createInfo.<a class="code" href="structktxTextureCreateInfo.html#ae817666a8c8ef8fbed5d81b52c421b9e">baseWidth</a>) + 1</div><div class="line">createInfo.<a class="code" href="structktxTextureCreateInfo.html#a237cfa756c1b49169d769442c1c5492a">numLayers</a> = 1;</div><div class="line">createInfo.<a class="code" href="structktxTextureCreateInfo.html#ad0f09614599bd18f0430d2e3e3f2acf1">numFaces</a> = 1;</div><div class="line">createInfo.<a class="code" href="structktxTextureCreateInfo.html#a7f6d6379fcb54b95769000b3919a659b">isArray</a> = KTX_FALSE;</div><div class="line">createInfo.<a class="code" href="structktxTextureCreateInfo.html#ae77eda256cb25882c635ca7515811f0e">generateMipmaps</a> = KTX_FALSE;</div><div class="line"></div><div class="line">result = <a class="code" href="group__writer.html#gaa051e6b5fe8d46c4af43cb03607c4b37">ktxTexture_Create</a>(createInfo,</div><div class="line">                           <a class="code" href="ktx_8h.html#a2ab4b656d36abc318aed17a5f73c505c">KTX_TEXTURE_CREATE_ALLOC_STORAGE</a>,</div><div class="line">                           &amp;texture);</div><div class="line"></div><div class="line">src = <span class="comment">// Open a stdio FILE* on the baseLevel image, slice 0.</span></div><div class="line">srcSize = <span class="comment">// Query size of the file.</span></div><div class="line">level = 0;</div><div class="line">layer = 0;</div><div class="line">faceSlice = 0;                           </div><div class="line">result = <a class="code" href="group__writer.html#ga1daf0f13b5c4d350d0bc6fd6f0c50351">ktxTexture_SetImageFromMemory</a>(texture, level, layer, faceSlice,</div><div class="line">                                       src, srcSize);</div><div class="line"><span class="comment">// Repeat for the other 15 slices of the base level and all other levels</span></div><div class="line"><span class="comment">// up to createInfo.numLevels.</span></div><div class="line"></div><div class="line"><a class="code" href="group__writer.html#gae88fe5bedf6cf3991a824459d1a2b73f">ktxTexture_WriteToNamedFile</a>(texture, <span class="stringliteral">&quot;mytex3d.ktx&quot;</span>);</div><div class="line"><a class="code" href="group__reader.html#ga87b33b5bb53c98814f888ef888c62476">ktxTexture_Destroy</a>(texture);</div></div><!-- fragment --><h2><a class="anchor" id="modifyktx"></a>
Modifying a KTX file</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="ktx_8h.html">ktx.h</a>&gt;</span></div><div class="line"></div><div class="line"><a class="code" href="structktxTexture.html">ktxTexture</a>* texture;</div><div class="line"><a class="code" href="ktx_8h.html#a8de6927e772cc95a9f49593c3dd72069">KTX_error_code</a> result;</div><div class="line">ktx_size_t offset;</div><div class="line">ktx_uint8_t* image;</div><div class="line">ktx_uint32_t level, layer, faceSlice;</div><div class="line"></div><div class="line">result = <a class="code" href="group__reader.html#ga57a1ce0d3f2d66439463160d6ce9d2d0">ktxTexture_CreateFromNamedFile</a>(<span class="stringliteral">&quot;mytex3d.ktx&quot;</span>,</div><div class="line">                                        <a class="code" href="ktx_8h.html#a5d741f48293002f70546881d2394b6f6">KTX_TEXTURE_CREATE_LOAD_IMAGE_DATA_BIT</a>,</div><div class="line">                                        &amp;texture);</div><div class="line"><span class="comment">// The file is closed after all the data has been read.</span></div><div class="line"></div><div class="line"><span class="comment">// It is the responsibilty of the application to make sure its</span></div><div class="line"><span class="comment">// modifications are valid.</span></div><div class="line">texture-&gt;<a class="code" href="structktxTexture.html#af66341d6f4dae10e412ced5542997042">generateMipmaps</a> = KTX_TRUE;</div><div class="line"></div><div class="line"><a class="code" href="group__writer.html#gae88fe5bedf6cf3991a824459d1a2b73f">ktxTexture_WriteToNamedFile</a>(texture, <span class="stringliteral">&quot;mytex3d.ktx&quot;</span>);</div><div class="line"><a class="code" href="group__reader.html#ga87b33b5bb53c98814f888ef888c62476">ktxTexture_Destroy</a>(texture);</div></div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Mar 13 2019 02:02:04 for libktx - The KTX Library by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
